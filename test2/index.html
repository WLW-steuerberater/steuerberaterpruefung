<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mündliche Prüfungssimulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://studio.pickaxe.co/api/embed/bundle.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            box-sizing: border-box;
        }
        
        .examiner-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(180deg, #6facff, #aacfff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin: 0 auto 12px;
        }
        
        .timer-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#ef4444 0deg, #f3f4f6 0deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .timer-inner {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
        }
        
        .question-bubble {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-left: 4px solid #6facff;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .phase-indicator {
            background: linear-gradient(180deg, #6facff, #aacfff);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
    </style>
</head>
<body class="min-h-screen" style="background: linear-gradient(180deg, #6facff, #aacfff);">
    

    <!-- Main Content -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="text-center">
            <div class="bg-white rounded-2xl shadow-lg p-8 max-w-2xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Willkommen zur Prüfungssimulation 1</h2>
                <!-- Prüfungskommission Vorschau -->
                <div class="mb-6">
                    <!-- Vorsitzender -->
                    <div class="text-center mb-4">
                        <div class="w-24 h-24 mx-auto mb-2 rounded-full overflow-hidden">
                            <img src="https://s1.directupload.eu/images/250829/f5677mip.jpg" alt="Dr. Dumser" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">DD</div>
                        </div>
                        <h4 class="font-semibold text-gray-800">Dr. Dumser</h4>
                        <p class="text-sm text-gray-600">Prüfungsvorsitzender</p>
                        
                        <!-- Welcome Audio direkt unter Dr. Dumser -->
                        <div class="mt-4">
                            <audio id="welcomeAudio" controls class="w-full" preload="metadata" autoplay>
                                <source src="https://www.dropbox.com/scl/fi/96bz0m47ena4y1teeb8bj/Begr-ung.mp3?rlkey=a5qrkbc8wi7572gjinsxn7dnl&st=1w64td4v&raw=1" type="audio/mpeg">
                                Ihr Browser unterstützt das Audio-Element nicht.
                            </audio>
                        </div>
                    </div>
                    
                    <!-- Weitere Prüfer -->
                    <div class="grid grid-cols-5 gap-3 max-w-lg mx-auto">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-1 rounded-full overflow-hidden">
                                <img src="https://s1.directupload.eu/images/250926/iyqmubkd.jpg" alt="Reinwald" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">DB</div>
                            </div>
                            <p class="text-xs text-gray-700 font-medium">Reinwald</p>
                            <p class="text-xs text-gray-500"> ESt, IStR, KöSt, GewSt</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-1 rounded-full overflow-hidden">
                                <img src="https://s1.directupload.eu/images/250829/zzdffhky.jpg" alt="Dr. Baretti" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">S</div>
                            </div>
                            <p class="text-xs text-gray-700 font-medium">Dr. Baretti</p>
                            <p class="text-xs text-gray-500"> Berufsrecht, VWL, BWL</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-1 rounded-full overflow-hidden">
                                <img src="https://s1.directupload.eu/images/250829/qoko6duz.jpg" alt="Wirth" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">W</div>
                            </div>
                            <p class="text-xs text-gray-700 font-medium">Wirth</p>
                            <p class="text-xs text-gray-500">AO, FGO, ErbSt</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-1 rounded-full overflow-hidden">
                                <img src="https://s1.directupload.eu/images/250829/8q6up3ep.jpg" alt="Scherf" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">P</div>
                            </div>
                            <p class="text-xs text-gray-700 font-medium">Scherf</p>
                            <p class="text-xs text-gray-500">USt</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-1 rounded-full overflow-hidden">
                                <img src="https://s1.directupload.eu/images/250926/mw5zoero.jpg" alt="Priller" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">R</div>
                            </div>
                            <p class="text-xs text-gray-700 font-medium">Priller</p>
                            <p class="text-xs text-gray-500"> BilSt, UmwSt</p>
                        </div>
                    </div>
                </div>
                
                <!-- Ablauf der Prüfung -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Ablauf der Prüfung</h3>
                    <div class="text-left max-w-md mx-auto space-y-2">
                        <div class="flex items-center">
                            <span class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">1</span>
                            <span class="text-gray-700">Thema auswählen & 30 Min. vorbereiten</span>
                        </div>
                        <div class="flex items-center">
                            <span class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">2</span>
                            <span class="text-gray-700">Vortrag halten & direktes Feedback erhalten</span>
                        </div>
                        <div class="flex items-center">
                            <span class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">3</span>
                            <span class="text-gray-700">Vertiefende Fragen der Prüfungskommission</span>
                        </div>
                    </div>
                </div>
                
                <button onclick="startExam()" class="text-white px-8 py-3 rounded-lg font-semibold transition-colors" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 4px 6px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Prüfung starten
                </button>
            </div>
        </div>

        <!-- Preparation Phase -->
        <div id="preparationPhase" class="hidden">
            <!-- Restart Button in Preparation Phase -->
            <div class="mb-6 text-right">
                <button onclick="restartExam()" class="text-gray-700 px-4 py-2 rounded-lg font-medium transition-all shadow-md bg-white border border-gray-300 hover:bg-gray-50" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Simulation neu starten
                </button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Timer -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl shadow-lg p-6 text-center sticky top-8">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">Vorbereitungszeit</h3>
                        <div class="timer-circle mx-auto mb-4" id="timerCircle">
                            <div class="timer-inner" id="timerDisplay">30:00</div>
                        </div>
                        <p class="text-sm text-gray-600">Nutze die Zeit, um deinen Vortrag zu strukturieren</p>
                    </div>
                </div>

                <!-- Topic Selection -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">Wähle dein Vortragsthema</h3>
                        <div class="space-y-3" id="topicOptions">
                            <!-- Topics will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">Gewähltes Thema</h3>
                        <div class="rounded-lg p-4" style="background: linear-gradient(180deg, rgba(111, 172, 255, 0.1), rgba(170, 207, 255, 0.1)); border: 1px solid rgba(111, 172, 255, 0.3);">
                            <p class="text-lg font-medium" style="color: #4a7bb8;" id="selectedTopic">
                                Bitte wähle zunächst ein Thema aus
                            </p>
                        </div>
                        
                        <div class="mt-6 text-center">
                            <button onclick="skipToExam()" id="proceedButton" disabled class="text-white px-8 py-3 rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 4px 6px rgba(111, 172, 255, 0.3);" onmouseover="if(!this.disabled) { this.style.transform='translateY(-1px)' }" onmouseout="this.style.transform='translateY(0)'">
                                Vorbereitung beenden
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Presentation Phase -->
        <div id="presentationPhase" class="hidden">
            <!-- Restart Button in Presentation Phase -->
            <div class="mb-6 text-right">
                <button onclick="restartExam()" class="text-gray-700 px-4 py-2 rounded-lg font-medium transition-all shadow-md bg-white border border-gray-300 hover:bg-gray-50" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Simulation neu starten
                </button>
            </div>
            
            <!-- Current Examiner -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center">
                        <div class="w-24 h-24 mr-4 rounded-full overflow-hidden">
                            <img src="https://s1.directupload.eu/images/250829/f5677mip.jpg" alt="Dr. Dumser" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">DD</div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">Dr. Dumser</h3>
                            <p class="text-gray-600">Prüfungsvorsitzender</p>
                        </div>
                    </div>
                </div>

                <!-- Current Question -->
                <div class="question-bubble rounded-lg p-6 mb-6" id="presentationQuestionContainer">
                    <div class="mb-3">
                        <p class="text-lg text-gray-800" id="presentationQuestion">
Ich hoffe Sie konnten die Vorbereitungszeit gut nutzen. Beginnen wir jetzt mit Ihrem Vortrag. Bitte stellen Sie sich zunächst vor. Nennen Sie am Anfang das Thema, für das Sie sich entschieden haben. Sie können Ihren Vortrag unten eingeben. Nutzen Sie gerne die Diktierfunktion Ihres Handys, damit Sie das Sprechen üben. Anschließend senden Sie Ihren Vortrag ab. Unsere künstliche Intelligenz bewertet ihn und gibt Ihnen Tipps. Unten können Sie einen Timer nutzen, die Musterlösung aufrufen oder mit den Prüfungsrunden starten.                        </p>
                    </div>
                    
                    <!-- Audio Player for Dr. Dumser -->
                    <div id="presentationAudioPlayer" class="mt-4">
                        <audio id="presentationAudio" controls class="w-full" preload="metadata">
                            <source src="https://www.dropbox.com/scl/fi/xrkxtywr0p376riknh47b/Vortrag.mp3?rlkey=nke47ekt6d8v7vj7tyhdaox3y&st=lyfjd7f3&raw=1" type="audio/mpeg">
                            Ihr Browser unterstützt das Audio-Element nicht.
                        </audio>
                    </div>
                </div>

                <!-- Response Area -->
                <div class="mb-6" id="presentationResponseArea">
                    <!-- Chat Widget for Presentation -->
                    <div id="presentationChatWidget">
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700">Ihr Vortrag an Dr. Dumser:</label>
                        </div>
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <div id="deployment-dbb15733-7d3c-44d6-98f1-132687e95879"></div>
                        </div>
                    </div>
                </div>

                <!-- Presentation Timer -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6 text-center">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Vortragszeit</h4>
                    <div class="text-2xl font-bold" style="color: #6facff;" id="presentationTimer">00:00</div>
                    <div class="flex justify-center gap-2 mt-3">
                        <button onclick="startPresentationTimer()" id="startTimerBtn" class="px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded text-sm font-medium transition-colors">
                            Start
                        </button>
                        <button onclick="pausePresentationTimer()" id="pauseTimerBtn" class="px-3 py-1 bg-yellow-500 hover:bg-yellow-600 text-white rounded text-sm font-medium transition-colors" disabled>
                            Pause
                        </button>
                        <button onclick="resetPresentationTimer()" id="resetTimerBtn" class="px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm font-medium transition-colors">
                            Reset
                        </button>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4">
                    <button onclick="finishPresentation()" class="text-white px-6 py-2 rounded-lg font-medium transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 2px 4px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(111, 172, 255, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(111, 172, 255, 0.3)'">
                        Prüfungsrunden starten
                    </button>
                    <button onclick="showSampleSolution()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium transition-colors">
                        Musterlösung
                    </button>
                </div>
            </div>
        </div>

        <!-- Transition Phase -->
        <div id="transitionPhase" class="hidden">
            <!-- Restart Button in Transition Phase -->
            <div class="mb-6 text-right">
                <button onclick="restartExam()" class="text-gray-700 px-4 py-2 rounded-lg font-medium transition-all shadow-md bg-white border border-gray-300 hover:bg-gray-50" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Simulation neu starten
                </button>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 text-center">
                <div class="flex items-center justify-center mb-6">
                    <div class="w-24 h-24 mr-4 rounded-full overflow-hidden">
                        <img src="https://s1.directupload.eu/images/250829/f5677mip.jpg" alt="Dr. Dumser" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">DD</div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800">Dr. Dumser</h3>
                        <p class="text-gray-600">Prüfungsvorsitzender</p>
                    </div>
                </div>

                <!-- Transition Message -->
                <div class="question-bubble rounded-lg p-6 mb-6">
                    <div class="mb-3">
                        <p class="text-lg text-gray-800">
                            Vielen Dank für Ihren Vortrag. Wir starten nun mit dem Prüfungsgespräch. Die Prüfer werden Ihnen in ihren jeweiligen Fachgebieten Fragen stellen. Bitte beantworten Sie diese. Den Anfang macht Frau Reinwald in Einkommensteuer.
                        </p>
                    </div>
                    
                    <!-- Audio Player for Transition -->
                    <div class="mt-4">
                        <audio id="transitionAudio" controls class="w-full" preload="metadata">
                            <source src="https://www.dropbox.com/scl/fi/n9sr1838ofcgy423mucns/Fragerunde.mp3?rlkey=mdcqz50ab825yor017u6mew9m&st=0nwgatl5&raw=1" type="audio/mpeg">
                            Ihr Browser unterstützt das Audio-Element nicht.
                        </audio>
                    </div>
                </div>

                <!-- Action Button -->
                <div class="mt-6">
                    <button onclick="startExamQuestions()" class="text-white px-8 py-3 rounded-lg font-semibold transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 4px 6px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                        Prüfungsgespräch beginnen
                    </button>
                </div>
            </div>
        </div>

        <!-- Exam Phase -->
        <div id="examPhase" class="hidden">
            <!-- Restart Button in Exam Phase -->
            <div class="mb-6 text-right">
                <button onclick="restartExam()" class="text-gray-700 px-4 py-2 rounded-lg font-medium transition-all shadow-md bg-white border border-gray-300 hover:bg-gray-50" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Simulation neu starten
                </button>
            </div>
            
            <!-- Current Examiner -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center">
                        <div id="currentExaminerAvatar" class="examiner-avatar mr-4">DB</div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800" id="currentExaminerName">Dr. Baretti</h3>
                            <p class="text-gray-600" id="currentExaminerField">Fachbereich: VWL & BWL</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500">Prüfer</div>
                        <div class="text-2xl font-bold" style="color: #6facff;" id="examinerProgress">1 / 6</div>
                    </div>
                </div>

                <!-- Current Question -->
                <div class="question-bubble rounded-lg p-6 mb-6" id="questionContainer">
                    <div class="mb-3">
                        <p class="text-lg text-gray-800" id="currentQuestion">
                            Bitte stellen Sie sich zunächst vor und beginnen Sie mit Ihrem Vortrag zum Thema "Die Auswirkungen der Digitalisierung auf moderne Arbeitsplätze".
                        </p>
                    </div>
                    
                    <!-- Audio Player for Dr. Schmidt -->
                    <div id="audioPlayer" class="mt-4 hidden">
                        <audio id="drSchmidtAudio" controls class="w-full" preload="metadata">
                            <source src="https://www.dropbox.com/scl/fi/jq9xlnehbcna73rvyyvej/ElevenLabs_2025-09-24T09_36_17_Liam_pre_sp100_s50_sb75_v3.mp3?rlkey=r7vgyfxqeqrmszlvbcqpe2kxw&raw=1" type="audio/mpeg">
                            Ihr Browser unterstützt das Audio-Element nicht.
                        </audio>
                    </div>
                </div>

                <!-- Response Area -->
                <div class="mb-6" id="responseArea">
                    <!-- Chat Widget for Dr. Baretti -->
                    <div id="chatWidget" class="hidden">
                        <!-- Text area for Dr. Baretti -->
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700">Ihre Antwort an Dr. Baretti:</label>
                            <div class="flex gap-2">
                                <button 
                                    onclick="clearBarettiResponse()" 
                                    class="px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors"
                                >
                                    Löschen
                                </button>
                            </div>
                        </div>
                        <textarea 
                            id="barettiResponse" 
                            placeholder="Geben Sie hier Ihre Antwort an Dr. Baretti ein..."
                            class="w-full h-32 p-4 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        ></textarea>
                    </div>
                    
                    <!-- Standard Text Area for other examiners -->
                    <div id="standardResponse">
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700">Ihre Antwort:</label>
                            <div class="flex gap-2">
                                <button 
                                    onclick="clearResponse()" 
                                    class="px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors"
                                >
                                    Löschen
                                </button>
                            </div>
                        </div>
                        <textarea 
                            id="currentResponse" 
                            placeholder="Geben Sie hier Ihre Antwort ein..."
                            class="w-full h-32 p-4 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        ></textarea>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4">
                    <button onclick="nextQuestion()" class="text-white px-6 py-2 rounded-lg font-medium transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 2px 4px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(111, 172, 255, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(111, 172, 255, 0.3)'">
                        Antwort abgeben & Lösung anzeigen
                    </button>
                </div>
            </div>

            <!-- Examiner Overview -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">Prüfungskommission</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4" id="examinerGrid">
                    <!-- Examiners will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Solution Phase -->
        <div id="solutionPhase" class="hidden">
            <!-- Restart Button in Solution Phase -->
            <div class="mb-6 text-right">
                <button onclick="restartExam()" class="text-gray-700 px-4 py-2 rounded-lg font-medium transition-all shadow-md bg-white border border-gray-300 hover:bg-gray-50" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Simulation neu starten
                </button>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center">
                        <div id="solutionExaminerAvatar" class="examiner-avatar mr-4">DB</div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800" id="solutionExaminerName">Dr. Baretti</h3>
                            <p class="text-gray-600" id="solutionExaminerField">Fachbereich: VWL & BWL</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500">Prüfer</div>
                        <div class="text-2xl font-bold" style="color: #6facff;" id="solutionExaminerProgress">1 / 6</div>
                    </div>
                </div>

                <!-- Question -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Frage:</h4>
                    <p class="text-gray-800" id="solutionQuestion">Welche konkreten Vorteile sehen Sie in der Digitalisierung für Unternehmen?</p>
                </div>

                <!-- Your Answer -->
                <div class="bg-blue-50 rounded-lg p-4 mb-6">
                    <h4 class="text-sm font-medium text-blue-700 mb-2">Ihre Antwort:</h4>
                    <p class="text-blue-800" id="solutionYourAnswer">Ihre Antwort wird hier angezeigt...</p>
                </div>

                <!-- Model Solution -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Musterlösung:</h4>
                    <div class="text-gray-800" id="solutionModelAnswer">
                        <p class="mb-3"><strong>Hauptvorteile der Digitalisierung für Unternehmen:</strong></p>
                        <ul class="list-disc list-inside space-y-2">
                            <li><strong>Effizienzsteigerung:</strong> Automatisierung wiederkehrender Prozesse reduziert Arbeitsaufwand und Fehlerquoten</li>
                            <li><strong>Kostensenkung:</strong> Langfristige Einsparungen durch optimierte Abläufe und reduzierte Personalkosten</li>
                            <li><strong>Verbesserte Datenanalyse:</strong> Bessere Entscheidungsgrundlagen durch datengetriebene Insights</li>
                            <li><strong>Erhöhte Flexibilität:</strong> Schnellere Anpassung an Marktveränderungen und Kundenbedürfnisse</li>
                            <li><strong>Neue Geschäftsmodelle:</strong> Erschließung digitaler Märkte und Services</li>
                            <li><strong>Verbesserte Kundenerfahrung:</strong> 24/7 Verfügbarkeit und personalisierte Services</li>
                        </ul>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4">
                    <button onclick="continueToNextQuestion()" class="text-white px-6 py-2 rounded-lg font-medium transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 2px 4px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(111, 172, 255, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(111, 172, 255, 0.3)'">
                        Weiter zur nächsten Frage
                    </button>
                    <button onclick="backToQuestion()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium transition-colors">
                        Zurück zur Frage
                    </button>
                </div>
            </div>

            <!-- Examiner Overview -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">Prüfungskommission</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4" id="solutionExaminerGrid">
                    <!-- Examiners will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Results Phase -->
        <div id="resultsPhase" class="hidden">
            <div class="bg-white rounded-2xl shadow-lg p-8 text-center max-w-2xl mx-auto">
                <div class="text-6xl mb-6">🎉</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Prüfung abgeschlossen!</h2>
                <p class="text-gray-600 mb-6">
                    Sie haben erfolgreich alle Fragen der 6 Prüfer beantwortet. 
                    In einer echten Prüfung würden Sie nun das Ergebnis erfahren.
                </p>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <p class="text-green-800 font-medium">
                        Simulation erfolgreich durchgeführt! 
                        Sie haben wertvolle Prüfungserfahrung gesammelt.
                    </p>
                </div>
                <button onclick="restartExam()" class="text-white px-8 py-3 rounded-lg font-semibold transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 4px 6px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                    Neue Simulation starten
                </button>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // BEARBEITBARER BEREICH: VORTRAGSTHEMEN
        // ========================================
        // Hier können Sie alle Vortragsthemen nach Kategorien bearbeiten
        
        const topicsByCategory = {
            // Gruppe 1: ESt, BilSt, etc
            "Bilanzsteuer": [
                "Steuerrechtliche Behandlung des Erwerbs und der Veräußerung eigener Anteile einer GmbH"
            ],
            // Gruppe 2: AO, BGB, etc
            "Abgabenordnung": [
                "Zwangsmittel im Steuerrecht"
            ],
            
            // Gruppe 3: Spezialgebiete
            "Umsatzsteuer": [
                "Geschäftsveräußerung im Ganzen"
            ]
        };

        // ========================================
        // BEARBEITBARER BEREICH: MUSTERLÖSUNGEN
        // ========================================
        // Hier können Sie die Musterlösungen für die Vorträge bearbeiten
        
        const presentationSolutions = {
            // Allgemeine Struktur für alle Themen
            general: {
                introduction: {
                    title: "1. Einleitung (2-3 Minuten)",
                    points: [
                        "<strong>Begrüßung:</strong> \"Sehr geehrte Damen und Herren der Prüfungskommission...\"",
                        "<strong>Themennennung:</strong> Klare Benennung des gewählten Themas",
                        "<strong>Gliederung:</strong> Kurze Übersicht über die Struktur des Vortrags",
                        "<strong>Relevanz:</strong> Warum ist dieses Thema für Steuerberater wichtig?"
                    ]
                },
                mainPart: {
                    title: "2. Hauptteil (8-10 Minuten)",
                    points: [
                        "<strong>Grundlagen:</strong> Definition und rechtliche Einordnung",
                        "<strong>Aktuelle Rechtslage:</strong> Relevante Gesetze, Verordnungen, BMF-Schreiben",
                        "<strong>Praktische Anwendung:</strong> Konkrete Beispiele aus der Beratungspraxis",
                        "<strong>Problembereiche:</strong> Häufige Streitpunkte und Unsicherheiten",
                        "<strong>Rechtsprechung:</strong> Wichtige BFH-Urteile und deren Auswirkungen"
                    ]
                },
                conclusion: {
                    title: "3. Schluss (2-3 Minuten)",
                    points: [
                        "<strong>Zusammenfassung:</strong> Die wichtigsten Punkte nochmals kurz",
                        "<strong>Ausblick:</strong> Zukünftige Entwicklungen oder geplante Änderungen",
                        "<strong>Beratungshinweise:</strong> Was sollten Mandanten beachten?",
                        "<strong>Abschluss:</strong> \"Vielen Dank für Ihre Aufmerksamkeit\""
                    ]
                }
            },
            
// Spezifische Musterlösungen für einzelne Themen (optional)
specific: {
    // Beispiel für ein spezifisches Thema:
    "Steuerrechtliche Behandlung des Erwerbs und der Veräußerung eigener Anteile einer GmbH": {
        introduction: {
            title: "Übersicht ",
            points: "**Gliederung**\n\n**Einleitung**\n\n**Wirtschaftliche Bedeutung des Erwerbs eigener Anteile**\n\n**Hauptteil**\n• **Handelsrechtliche Grundlagen**\n• **Steuerrechtliche Konsequenzen für die Gesellschaft**\n• **Steuerrechtliche Konsequenzen für den Gesellschafter**\n\n**Schluss**\n**Verzerrungen aufgrund fehlendem Direktzugriff auf steuerliches Einlagekonto**"            
        },
        mainPart: {
            title: "2. Hauptteil - Kleinunternehmerregelung",
            points: [
                "<strong>Umsatzgrenzen:</strong> 22.000 € Vorjahr, 50.000 € laufendes Jahr",
                "<strong>Steuerbefreiung:</strong> Keine USt auf Ausgangsrechnungen",
                "<strong>Kein Vorsteuerabzug:</strong> Wichtiger Nachteil bei hohen Investitionen",
                "<strong>Verzichtsmöglichkeit:</strong> Regelbesteuerung für 5 Jahre bindend",
                "<strong>Rechnungsangaben:</strong> Pflichthinweis auf Steuerbefreiung"
            ]
        },
        conclusion: {
            title: "3. Schluss - Kleinunternehmerregelung",
            points: [
                "<strong>Beratungshinweis:</strong> Individuelle Prüfung der Vor- und Nachteile",
                "<strong>Grenzüberschreitung:</strong> Automatischer Wechsel zur Regelbesteuerung",
                "<strong>Dokumentation:</strong> Sorgfältige Umsatzüberwachung erforderlich"
            ]
        }
    },

    // NEU hinzugefügt: Musterlösung für Probe
    "Probe": {
        introduction: {
            title: "1. Einleitung – Probe",
            points: [
                "<strong>Begrüßung & Thema:</strong> Vorstellung des Themas 'Probe'",
                "<strong>Relevanz:</strong> Warum dieses Thema wichtig ist",
                "<strong>Gliederung:</strong> Übersicht über den Aufbau des Vortrags"
            ]
        },
        mainPart: {
            title: "2. Hauptteil – Probe",
            points: [
                "<strong>Grundlagen:</strong> Definition und Einordnung",
                "<strong>Praxis:</strong> Beispiele oder typische Anwendungsfälle",
                "<strong>Probleme:</strong> Herausforderungen und Lösungsansätze"
            ]
        },
        conclusion: {
            title: "3. Schluss – Probe",
            points: [
                "<strong>Zusammenfassung:</strong> Wichtigste Aussagen kurz wiederholen",
                "<strong>Ausblick:</strong> Wohin die Entwicklung geht",
                "<strong>Abschluss:</strong> „Vielen Dank für Ihre Aufmerksamkeit.“"
            ]
        }
    }
    // Weitere spezifische Themen können hier hinzugefügt werden...
}
};
        // ========================================
        // ENDE DES BEARBEITBAREN BEREICHS
        // ========================================

        // Function to stop all audio elements
        function stopAllAudio() {
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(audio => {
                if (!audio.paused) {
                    audio.pause();
                    audio.currentTime = 0;
                }
            });
        }
// Sicherer Phasenwechsel ohne Header
function setPhase(text) {
    const el = document.getElementById('phaseIndicator');
    if (el) el.textContent = text;
}

        let selectedTopicText = '';

        // Exam data with solutions
        const examinerData = [
            {
                name: "Reinwald",
                field: " ESt, IStR, KöSt, GewSt", 
                avatar: "R",
                image: " https://s1.directupload.eu/images/250926/iyqmubkd.jpg ",
                rounds: [
                    [
                        {
                            question: "Wir starten mit der Einkommensteuer: Stellen wir uns mal folgendes vor: Ihr Mandant ist ein Prominenter und begibt sich nach Australien und ist Teilnehmer am „Dschungelcamp“. Er erhält hierfür eine Gage und verpflichtet sich zur Weisungsgebundenheit und der Leistung von Aufgaben. Er hat dabei die Rechte am Filmmaterial an den Sender abgetreten. Welche Einkünfte erzielt der prominente Mandant mit seiner Gage?",
                            audio: "https://www.dropbox.com/scl/fi/iv9ou1l5vbuouxy61bk9p/k.r.1.mp3?rlkey=qqahd59z9kobr61ujzgbyuu00&st=l9aab1mx&raw=1",
                            solution: "Vorweg ist anzumerken, dass **keine gewerblichen Einkünfte i. S. d. § 15 EStG** vorliegen.\nDie **Voraussetzungen des § 15 Abs. 2 EStG** sind **nicht alle erfüllt** – insbesondere fehlt es an der **Nachhaltigkeit**.\n\nDarüber hinaus liegen auch **keine selbständigen Einkünfte i. S. d. § 18 EStG** vor, da insoweit **kein Katalogberuf** vorliegt.\n\nAuch die **Einkünfte aus nichtselbständiger Arbeit** können ausgeschlossen werden, weil **kein abhängiges Arbeitsverhältnis i. S. d. § 19 EStG** besteht.\n\nDerartige **Gagen sind daher gem. § 22 Nr. 3 EStG zu versteuern**, weil diese **Leistungen um des Entgelts willen erbracht** werden.\nEntscheidendes Kriterium für die Steuerbarkeit ist, dass der **Auftritt des Kandidaten** und das **gewonnene Preisgeld** in einem **gegenseitigen Leistungsverhältnis** stehen.\n\nAls Anhaltspunkt für ein derartiges Leistungsverhältnis gilt z. B., dass dem Kandidaten von Seiten des Produzenten ein **bestimmtes Verhaltensmuster oder Ähnliches vorgegeben** wird oder dass er **neben der Gewinnchance** und dem damit verbundenen **Preisgeld** noch ein **erfolgsunabhängiges Antritts- oder Tagegeld** erhält (**BMF v. 30.05.2008, Beck’sche StErlasse 1 § 22/3**)."
                        },
                        {
                            question: "Jetzt sind wir ja schon beim Thema der Abgrenzung der Einkunftsarten. Dann können Sie mir bestimmt folgendes beantworten: Wie ist die Tätigkeit beziehungsweise Einkunftsart eines selbständigen Handelsvertreters mit Einkünften nach § 15 EStG zu einem angestellten Handelsvertreter mit Einkünften nach § 19 EStG abzugrenzen?",
                            audio: "https://www.dropbox.com/scl/fi/b232lergyu52dg8ee82gg/k.r.2.mp3?rlkey=ht4iwt8g3qg5y6bhywh9teety&st=fe9e5i0j&raw=1",
                            solution: "Für die **Selbständigkeit eines Handelsvertreters** sprechen:\n**Unternehmerrisiko**, **Unternehmerinitiative**, **Selbständigkeit in Organisation und Durchführung** der eigenen Tätigkeit, **eigene Kostentragung**, **Beschäftigung eigener Arbeitnehmer**, **Unterhalt eines eigenen Büros**, **geschäftlicher Kontakt zu mehreren Auftraggebern**, **freie Erledigung des Auftrags**, **Fehlen einer Urlaubsregelung und einer festen Arbeitszeit**, sowie **keine Eingliederung in den Betrieb des Auftraggebers**.\nAuch die **Vergütungsart** kann von Bedeutung sein. Für die Selbständigkeit spricht insbesondere eine **Vergütung nach dem Erfolg**.\nEine festgestellte Selbständigkeit führt zu **gewerblichen Einkünften nach § 15 Abs. 1 S. 1 Nr. 1 EStG**.\n\nFür die **Arbeitnehmereigenschaft eines Handelsvertreters** sprechen:\n**Kein Unternehmerrisiko**, **keine Unternehmerinitiative**, **persönliche Abhängigkeit vom Auftraggeber**, **Weisungsgebundenheit** insbesondere im Hinblick auf **Ort, Zeit und Inhalt der Tätigkeit**, **Eingliederung in den Betrieb**, **feste Bezüge**, **fehlender Kapitaleinsatz**, **keine Pflicht zur Beschaffung von Arbeitsmitteln**, **Schulden der Arbeitskraft und nicht des Arbeitserfolgs**, **Ausführung einfacher Tätigkeiten** mit typischer **Weisungsabhängigkeit**, **feste Arbeitszeit**, **Tätigkeit an einem gleichbleibenden Ort**, **Urlaubsanspruch**, **Fortzahlung von Bezügen im Krankheitsfall**, **Anspruch auf Sozialleistungen** und **Überstundenvergütung**.\nEine festgestellte **Arbeitnehmereigenschaft** führt zu **Einkünften aus nichtselbständiger Arbeit i. S. d. § 19 Abs. 1 S. 1 Nr. 1 EStG**."
                        },
                        {
                            question: "In Ordnung. Kommen wir zu einem anderen Thema. Was verstehen Sie unter dem Begriff „horizontaler“ und „vertikaler“ Verlustausgleich?",
                            audio: "https://www.dropbox.com/scl/fi/9nuy33jfx9rtb3nxedqyw/k.r.3.mp3?rlkey=53wuimwunl980szgmdrjrzrfq&st=ofi2ovld&raw=1",
                            solution: "**Horizontaler Verlustausgleich** ist der **Ausgleich von Verlusten mit positiven Einkünften derselben Einkunftsart**.\n**Vertikaler Verlustausgleich** ist die **Verrechnung von Verlusten mit positiven Einkünften einer anderen Einkunftsart** (**§ 2 Abs. 3 EStG**)."
                        },
                        {
                            question: "Den Themenbereich Körperschaftsteuer möchte ich auch noch abprüfen. Betrachten wir mal die Gründungsstadien einer GmbH bezüglich der Körperschaftsteuerpflicht: Wann liegt was vor? Welche Rechtsformen sind gegeben? Wer muss welche Steuererklärung abgeben? Was passiert mit Vorgesellschaft, die doch nicht zustande kommt?",
                            audio: "https://www.dropbox.com/scl/fi/01ihmwqwhmyva1r725j4u/k.r.4.mp3?rlkey=o5wi1xnqsyvv6gbh8qjfjfpa7&st=uz4trhwh&raw=1",
                            solution: "**Phasen der Gründung einer GmbH:**\n\n**1. Vorgründungsgesellschaft:** entsteht mit der (formlosen) **Vereinbarung über die Absicht zur Gründung einer GmbH**.\nSofern diese bereits (vor Abschluss des notariellen Gesellschaftsvertrages) eine Tätigkeit entfaltet, liegt eine **oHG oder GbR** vor (bei **Einmann-GmbH:** Einzelunternehmen), die **nicht mit der später zu gründenden GmbH identisch** ist.\n**Steuerlich** ist eine **gesonderte und einheitliche Gewinnfeststellung** durchzuführen.\nDie **Einkünfte sind den beteiligten Gründungsgesellschaftern zuzurechnen** und von diesen **anteilig zu versteuern**.\n\n**2. Vorgesellschaft (= GmbH in Gründung):** entsteht mit dem **Abschluss des notariellen Gesellschaftsvertrages**.\nSofern diese bereits tätig wird, **beginnt die Körperschaftsteuerpflicht vor Eintragung der GmbH** in das Handelsregister.\nDies gilt jedoch nur, wenn die GmbH auch **tatsächlich in das HR eingetragen** wird.\nUnterbleibt die Eintragung ins HR, z. B. weil die erforderlichen Unterlagen nicht vorgelegt werden, wird die sog. **unechte Vorgesellschaft steuerlich wie eine Vorgründungsgesellschaft behandelt**.\nDas bedeutet: **keine Körperschaftsteuerpflicht**, die **Einkünfte werden den Gründungsgesellschaftern zugerechnet**.\nDie **Gewerbesteuerpflicht** beginnt, wenn die Vorgesellschaft **nicht nur Vorbereitungshandlungen** im Rahmen der Unternehmensgründung vornimmt (**BFH v. 24.01.2017, I R 81/15, BStBl. 2017 II S. 1071**).\n\n**3. GmbH:** entsteht **zivilrechtlich mit der Eintragung in das Handelsregister (HR)**.\nSpätestens zu diesem Zeitpunkt **beginnt die Körperschaftsteuerpflicht (KSt-Pflicht)**."
                        }
                    ]
              ]
            },
            {
                name: "Dr. Baretti",
                field: " Berufsrecht, VWL, BWL",
                avatar: "B",
                image: "https://s1.directupload.eu/images/250829/zzdffhky.jpg",
                rounds: [
                    [
                        {
                            question: "Können Sie mir zunächst sagen, wo das Berufsrecht der Steuerberater geregelt ist? In welchen Gesetzen oder Verordnungen finden wir die wesentlichen Vorschriften?",
                            audio: "https://www.dropbox.com/scl/fi/mwbxn2li96043tzfpjp02/K.c.1.mp3?rlkey=ncje8ud4u29hzp4s9p6q8u589&st=a7pdl6sb&raw=1",
                            solution: "Gesetzliche Grundlagen der Steuerberatung:\n• **Im Steuerberatungsgesetz** sowie\n• **In der Durchführungsverordnung zum Steuerberatungsgesetz:** Diese ist formal kein Gesetz, sondern eine Rechtsverordnung.\n• **Daneben in der Berufsordnung der Bundessteuerberaterkammer,** die ebenfalls kein Gesetz darstellt.\n• **Des Weiteren in der Steuerberatervergütungsverordnung,** die formal kein Gesetz, sondern eine Rechtsverordnung ist."
                        },
                        {
                            question: " Was braucht man denn alles, um zur Steuerberaterin bzw. zum Steuerberater bestellt zu werden? Welche Voraussetzungen müssen dafür erfüllt sein?",
                            audio: "https://www.dropbox.com/scl/fi/hhecquyxqqmq4bhcgpseq/K.c.2.mp3?rlkey=syqdw36i9n1eo5s96786llgn2&st=0o7djh9f&raw=1",
                            solution: "Für die Bestellung ist nach § 40 Steuerberatungsgesetz folgendes erforderlich:\n• **Die bestandene Prüfung**\n• **Keine Ausübung einer mit dem Beraterberuf unvereinbaren Tätigkeit**\n• **Eine Deckungszusage der Berufshaftpflichtversicherung**\n• **Geordnete wirtschaftliche Verhältnisse**\n• **Keine gesundheitlichen Gründe,** welche der Berufsausübung dauerhaft entgegenstehen\n• **Eine berufliche Niederlassung**\n• **Ein Führungszeugnis** zur Vorlage bei einer Behörde"
                        },
                        {
                            question: " Dann noch eine Frage zu den amtlichen Fachberatertiteln: Welche Fachberatertitel gibt es derzeit, die von der Steuerberaterkammer offiziell verliehen werden können?",
                            audio: "https://www.dropbox.com/scl/fi/tgytqdhuhxsrvk439gxlw/K.c.3.mp3?rlkey=0jaz9p0dq1667rzxa9r9gm9kc&st=z1pcwcm5&raw=1",
                            solution: " Gemäß der Fachberaterordnung gibt es derzeit:\n• **Den Fachberater für Internationales Steuerrecht**\n• **Den Fachberater für Zölle und Verbrauchsteuern**"
                        },
                        {
                            question: " Und darf man den Titel „Fachberater für Unternehmensnachfolge“ eigentlich zusammen mit dem Steuerberatertitel führen, oder gibt es da Beschränkungen?",
                            audio: "https://www.dropbox.com/scl/fi/k2t6wo1jqsa4dus9hilgs/K.c.4.mp3?rlkey=vmjhg5fymoa2lxc46ney7arns&st=u482py5b&raw=1",
                            solution: " **Bei der genannten Bezeichnung handelt es sich um einen vom Deutschen Steuerberaterverband vergebenen, nicht amtlichen Fachberatertitel.**\nDie **Fachbezeichnungen des Deutschen Steuerberaterverbands** dürfen von Steuerberatern **werbend verwendet werden**, sofern dies **nicht im unmittelbaren räumlichen Zusammenhang mit der Berufsbezeichnung „Steuerberater“** geschieht.\nDas bedeutet, dass die **Fachberaterbezeichnungen des Deutschen Steuerberaterverbands nicht als Zusatz zur Berufsbezeichnung**, also **nicht in unmittelbarer räumlicher Nähe zum Steuerberatertitel**, geführt werden dürfen.\n**Nicht amtliche Fachberaterbezeichnungen** müssen außerdem **klarstellend die Angabe der verleihenden Institution enthalten** (z. B. „Fachberater für Unternehmensnachfolge“ (**Deutscher Steuerberaterverband e.V.**)."
                        }
                    ]
                ]
            },
            {
                name: "Scherf",
                field: "Umsatzsteuer",
                avatar: "S",
                image: "https://s1.directupload.eu/images/250829/8q6up3ep.jpg",
                rounds: [
                    [
                        {
                            question: "Beginnen wir mit etwas Grundlegendem: Können Sie mir erklären, was eine Umsatzsteuer-Identifikationsnummer ist? Wissen Sie auch, wo diese gesetzlich geregelt ist und wer sie vergibt?",
                            audio: "https://www.dropbox.com/scl/fi/r3xja24bgobb3hrp3aez1/K.d.1.mp3?rlkey=et5wh9ao43mnezfcp2hrqfgr4&st=y7aa9uzj&raw=1",
                            solution: " Die **USt-IdNr.** ist eine eindeutige Kennzeichnung eines Unternehmers innerhalb der **EU** im umsatzsteuerlichen Sinne.\nSie dient innerhalb der EU zur Abwicklung des **innergemeinschaftlichen Waren- und Dienstleistungsverkehrs** für Umsatzsteuerzwecke. Die USt-IdNr. wird daher von jedem Unternehmer benötigt, der innerhalb des Gebiets der EU am Waren- und Dienstleistungsverkehr zwischen den Mitgliedsstaaten teilnimmt.\nDie gesetzliche Fundstelle ist **§ 27a UStG**; dort ist geregelt, dass das **Bundeszentralamt für Steuern (BZSt)** Unternehmern i. S. d. § 2 UStG auf Antrag eine USt-IdNr. erteilt.\nDer Antrag auf Erteilung einer **USt-IdNr.** ist **schriftlich** zu stellen; in dem Antrag sind **Name, Anschrift und Steuernummer** anzugeben."
                        },
                        {
                            question: " Ich hätte dazu außerdem einen kleinen Fall für Sie: Das in Wien ansässige Unternehmen A liefert ein Swimming Pool-Reinigungsgerät für 4.000 € an den in Deutschland wohnhaften Sportarzt S, der es zu privaten Zwecken nutzt. Im Vorjahr hat A noch keine Umsätze ausgeführt. Im laufenden Jahr hat er nur diesen Umsatz. Was würden Sie sagen – was liegt hier vor?",
                            audio: " https://www.dropbox.com/scl/fi/h4b28knfgxp20vs2vsv6l/k.d.2.mp3?rlkey=91fly07c432dry23jnfese6nt&st=gkvf8o1k&raw=1",
                            solution: "Es handelt sich um eine **Lieferung nach § 3 Abs. 1 UStG**, Ort **§ 3 Abs. 6 UStG** bei Beginn in **Wien**.\nDa das Reinigungsgerät für den **privaten Bereich** erworben wird, liegt **kein innergemeinschaftlicher Erwerb nach § 1a UStG** vor."
                        },
                        {
                            question: "Welcher Steuersatz findet Anwendung – der deutsche oder der österreichische? Und unter welchen Umständen könnte der österreichische Unternehmer trotzdem deutsche Umsatzsteuer ausweisen?",
                            audio: "https://www.dropbox.com/scl/fi/ser10le1lrz29rqjeaehm/K.d.3.mp3?rlkey=dyuna3ufk6ifo5zxppmj8tzq8&st=518viem2&raw=1",
                            solution: "Der **österreichische Steuersatz**, da der **Ort in Österreich** liegt.\nWenn der **österreichische Unternehmer** das Reinigungsgerät zu einer **deutschen Betriebsstätte** bringt und von dort verschickt."
                        },
                        {
                            question: "Was heißt es dann für den österreichischen Unternehmer, wenn er das Reinigungsgerät aus Österreich zu seiner deutschen Betriebsstätte verschickt?",
                            audio: " https://www.dropbox.com/scl/fi/cca0cbx0wawz912gi7x1w/k.d.4.mp3?rlkey=917lz8b2zzvsejfwjkistnxqk&st=zkdfw6jp&raw=1",
                            solution: "Er hat einen **innergemeinschaftlichen Erwerb** in Form eines **innergemeinschaftlichen Verbringens nach § 1a Absatz 2 UStG** in **Deutschland**."
                        },
{
                            question: "Liegt hier nicht ggf. ein § 3c UStG vor, wenn das Reinigungsgerät aus Österreich geliefert wird?",
                            audio: "https://www.dropbox.com/scl/fi/a2jy3ry3wbgzhzfyrtrdx/k.d.5.mp3?rlkey=zjwzugdb0l7kfpemkkg2embd3&st=j72nd82w&raw=1",
                            solution: "Nein, der **Fernverkauf nach § 3c UStG** ist **nicht anwendbar**, weil das Reinigungsgerät lediglich **4.000 €** gekostet hat.\nDie **Umsatzschwelle von 10.000 €** nach § 3c Abs. 4 UStG wurde **im Vorjahr** nicht überschritten und wird **im laufenden Jahr** nicht überschritten."
                        }
                    ]
                ]
            },
            {
                name: "Priller",
                field: " BilSt, UmwSt",
                avatar: "P",
                image: "https://s1.directupload.eu/images/250926/mw5zoero.jpg",
                rounds: [
                    [
                        {
                            question: "Wir kommen zu den wichtigen Dingen des Lebens, der Bilanzsteuer. Jetzt höchste Konzentration bitte! Was sind denn die Bestandteile eines Jahresabschlusses?",
                            audio: "https://www.dropbox.com/scl/fi/b1ccc0gmb44tdfd2b4lte/k.h.1.mp3?rlkey=x0vdhrdqje8kgt3iltevj18bi&st=v0i83akt&raw=1",
                            solution: "Einzelabschluss- und Konzernabschluss setzen sich zusammen aus:\n• **Bilanz**\n• **GuV-Rechnung**\n• **Anhang**\n\nDer **Konzernabschluss** wird ergänzt um:\n• **Die Kapitalflussrechnung**\n• **Die Segmentberichterstattung**\n• **Den Eigenkapitalspiegel**\n\nNicht zum Jahresabschluss zählt hingegen der **Lagebericht**."
                        },
                        {
                            question: "Was verstehen Sie unter Kleinstkapitalgesellschaften? Wo sind diese geregelt? Welche Erleichterungen gibt es bei Kleinstkapitalgesellschaften?",
                            audio: "https://www.dropbox.com/scl/fi/hqn27fmkgac7o9a48g5nx/k.h.2.mp3?rlkey=kd5i17lh0479xbq9oraejvb9u&st=c7r0pkyv&raw=1",
                            solution: "Die **Definition einer Kleinstkapitalgesellschaft** ist in **§ 267a HGB** geregelt.\nFolgende **wesentliche Erleichterungen** existieren gegenüber der Rechnungslegung kleiner Kapitalgesellschaften:\n• **Verzicht auf die Aufstellung eines Anhangs**, wenn einige wesentliche Angaben unter der Bilanz dargestellt werden (Haftungsverhältnisse, Darlehen an Mitglieder des Geschäftsführungsorgans, Bestand an eigenen Aktien der Gesellschaft),\n• **Verzicht auf die Bekanntmachung/Offenlegung der Rechnungslegungsunterlagen** im Falle der Hinterlegung der Bilanz sowie der Angaben unter der Bilanz,\n• **Verkürzte Darstellung von Bilanz** (nur Buchstabenpositionen) und **GuV** (8 Nummern)."
                        },
                        {
                            question: "Gut, folgendes Gedankenspiel: Ein Mandant sucht Sie in Ihrer Praxis auf, hat einen handelsrechtlichen Jahresabschluss dabei und fragt Sie, wie er nun Steuern sparen kann. Es ging hauptsächlich um die inner- und außerbilanziellen Wahlrechte sowie um die Frage der Veranlagung. Was raten Sie ihm?",
                            audio: "https://www.dropbox.com/scl/fi/t3h1rh8n7ps2hpmo8ikfb/k.h.3.mp3?rlkey=k835c8hkwo8v358nujrxvpwsp&st=auqm0zn7&raw=1",
                            solution: "Als **steuerliche Wahlrechte innerhalb der Bilanz** kommen z. B. in Betracht:\n• **Bildung einer Rücklage** (§ 6b-Rücklage, RfE, Zuschussrücklage)\n• **Vornahme einer Teilwertabschreibung (TW-Abschreibung)** gem. **§ 6 Abs. 1 Nr. 1 S. 2 EStG**, **§ 6 Abs. 1 Nr. 2 S. 2 EStG**\n• **Degressive Abschreibung** für die Jahre **2020–2022**, zwischen **01.04.2024 und 31.12.2024** sowie zwischen **01.07.2025 und 31.12.2027**\n• **Neu ab 01.07.2025 (bis 31.12.2027): Degressive Abschreibung für Elektrofahrzeuge**, **§ 7 Abs. 2a EStG**\n• **Anwendung des LiFo-Verfahrens** gem. **§ 6 Abs. 1 Nr. 2a EStG**\n• **Bewertungsfreiheit für geringwertige Wirtschaftsgüter** gem. **§ 6 Abs. 2 EStG**, **Sammelposten** gem. **§ 6 Abs. 2a EStG**\n• **Vornahme einer Sonderabschreibung** gem. **§ 7g Abs. 5 EStG**, **AK-Kürzung innerhalb der Bilanz** gem. **§ 7g Abs. 2 S. 3 EStG**\n• **Sonderabschreibung für Mietwohnungsneubau** nach **§ 7b EStG**\n\n**Steuerliche Wahlrechte außerhalb der Bilanz:**\n• **Vornahme eines Investitionsabzugsbetrags** gem. **§ 7g Abs. 1 EStG**"
                        },
                        {
                            question: "Da ich ja Umwandlungssteuerecht auch mit prüfe, noch eine Frage zu Umwandlung. Welche Umwandlungsarten nach dem Umwandlungsgesetz gibt es, und wo sind diese geregelt?",
                            audio: "https://www.dropbox.com/scl/fi/4ecicrkw6eiahf498jsaw/k.h.4.mp3?rlkey=iowafzh71d800x32rnt7t43ma&st=vxurpzgc&raw=1",
                            solution: "Es gibt insgesamt **vier Umwandlungsarten**, die in **§ 1 Abs. 1 UmwG** genannt sind.\nDemnach können **Rechtsträger mit Sitz im Inland** umgewandelt werden:\n**1. Durch Verschmelzung** (§§ 2 - 122 UmwG)\n**2. Durch Spaltung** (Aufspaltung, Abspaltung, Ausgliederung) (§§ 123 - 173 UmwG)\n**3. Durch Vermögensübertragung** (§§ 174 - 189 UmwG)\n**4. Durch Formwechsel** (§§ 190 - 304 UmwG)"
                        }
                    ]
                ]
            },
            {
                name: "Dr. Dumser",
                field: "BGB, HGB, InsO, EuropaR",
                avatar: "DD",
                image: "https://s1.directupload.eu/images/250829/f5677mip.jpg",
                rounds: [
                    [
                        {
                            question: " Für meine erste Frage bitte ich Sie, nicht ins Gesetz zu schauen. Können Sie mir aus dem Gedächtnis sagen, wie das Bürgerliche Gesetzbuch aufgebaut ist?",
                            audio: "https://www.dropbox.com/scl/fi/u2p3k8xjptqe39ltljgdp/K.k.1.mp3?rlkey=gye2p45k0d4a7ixkwqzb7xu2m&st=wxolzvxf&raw=1 ",
                            solution: " Das **BGB** ist in **5 Bücher** unterteilt:\n**1. Buch: Allgemeiner Teil** (§§ 1 - 240 BGB)\n**2. Buch: Recht der Schuldverhältnisse (Schuldrecht)** (§§ 241 - 853 BGB)\n**3. Buch: Sachenrecht** (§§ 854 - 1296 BGB)\n**4. Buch: Familienrecht** (§§ 1297 - 1921 BGB)\n**5. Buch: Erbrecht** (§§ 1922 - 2385 BGB)\n\nSystematisch gesehen wurden die Regelungen des **Ersten Buchs des BGB „vor die Klammer gezogen“**. Es handelt sich also bei den §§ 1 - 240 BGB um **allgemeine Regelungen**, die auch im Rahmen der in den weiteren Büchern des BGB geregelten Rechtsgebiete Anwendung finden können."
                        },
                        {
                            question: " Wenn wir über Personen im Zivilrecht sprechen, fallen oft Begriffe wie Rechtsfähigkeit oder Geschäftsfähigkeit. Können Sie mir erklären, was diese Begriffe bedeuten und wie sie sich voneinander unterscheiden?",
                            audio: "https://www.dropbox.com/scl/fi/9qdtomo62qx23k0nsf16g/K.k.2.mp3?rlkey=jehn43xazfyerjng9vkrnrqfj&st=bbc90t59&raw=1",
                            solution: " **Rechtsfähigkeit** bedeutet die Fähigkeit, **Träger von Rechten und Pflichten** zu sein. Rechtsfähig sind sowohl **natürliche Personen** (vgl. § 1 BGB) als auch **juristische Personen** (vgl. §§ 21, 22 BGB).\n\\n**Geschäftsfähigkeit** ist die Fähigkeit rechtsfähiger Personen, durch **eigene Willenserklärungen selbst wirksam Rechte und Pflichten zu begründen** und damit Rechtsgeschäfte abzuschließen."
                        },
                        {
                            question: "Schauen wir uns den Begriff der Geschäftsfähigkeit genauer an. Wie kann man die Geschäftsfähigkeit unterteilen?",
                            audio: "https://www.dropbox.com/scl/fi/swlkvjvervy7dzeydi7ol/K.k.3.mp3?rlkey=h9lz87ttn6665d2noi4nvnafd&st=y6fxt7i5&raw=1",
                            solution: "Bei der **Geschäftsfähigkeit** ist wie folgt zu unterscheiden:\n• **Unbeschränkte bzw. volle Geschäftsfähigkeit:** Voll geschäftsfähig sind natürliche Personen, die das **18. Lebensjahr vollendet** haben, also volljährig sind (§ 2 BGB).\n• **Beschränkte Geschäftsfähigkeit (§§ 106 bis 113 BGB):** Minderjährige, die das **7. Lebensjahr** (aber noch nicht das **18. Lebensjahr**) vollendet haben, sind **beschränkt geschäftsfähig**, § 106 BGB. Die Beschränkung der Geschäftsfähigkeit besteht nach Maßgabe der §§ 107 - 113 BGB.\n• **Partielle Geschäftsfähigkeit (§§ 112, 113 BGB):** Soweit die **generelle Einwilligung des gesetzlichen Vertreters** im Rahmen der §§ 112 und 113 BGB reicht, also im Bereich des **selbständigen Betriebs eines Erwerbsgeschäfts** oder eines **Dienst- bzw. Arbeitsverhältnisses**, ist der Minderjährige **partiell geschäftsfähig**, also teilgeschäftsfähig. Das bedeutet, dass die gesetzlichen Vertreter für den Minderjährigen insoweit **kein Vertretungsrecht besitzen** und der Minderjährige **selbst wirksam rechtsgeschäftlich tätig werden** kann.\n• **Geschäftsunfähigkeit (§§ 104, 105 BGB):** Geschäftsunfähig sind gem. § 104 BGB natürliche Personen, die das **7. Lebensjahr noch nicht vollendet** haben und natürliche Personen, bei denen **nicht nur vorübergehend eine krankhafte Störung der Geistestätigkeit** vorliegt, welche die **freie Willensbestimmung ausschließt**."
                        },
                        {
                            question: "Ich habe folgenden Fall mit zwei Varianten mitgebracht: \nEin Jugendlicher hat sich von seinem Taschengeld 300 Euro zusammengespart. Davon kauft er sich ohne Zustimmung seiner Eltern ein Fahrrad. Was meinen Sie – ist dieser Kaufvertrag wirksam? \n \nUnd jetzt stellen wir uns vor, das Fahrrad kostet 500 Euro. Der Minderjährige zahlt 300 Euro sofort aus seinem Ersparten und vereinbart, die restlichen 200 Euro in Raten zu je 50 Euro aus seinem Taschengeld zu zahlen. Wie wäre die rechtliche Beurteilung in diesem Fall – bleibt es beim vorherigen Ergebnis?",
                            audio: "https://www.dropbox.com/scl/fi/2el575rjg2ezkhcw9gl2m/K.k.4.mp3?rlkey=rvgl9sj22nooogr08qbieq5fi&st=e4t0ojil&raw=1",
                            solution: "Der von dem Minderjährigen geschlossene **Kaufvertrag i. S. d. § 433 BGB** ist **wirksam geschlossen** worden.\nDer Minderjährige ist zwar in seiner **Geschäftsfähigkeit beschränkt (§ 106 BGB)**. Durch den Kaufvertrag wurde der Minderjährige zur **Kaufpreiszahlung verpflichtet**, weshalb der Vertrag für ihn **nicht lediglich rechtlich vorteilhaft** ist (§ 107 BGB).\nZu seinen Gunsten greift jedoch der **„Taschengeldparagraph“ (§ 110 BGB)**. Ein von dem Minderjährigen **ohne Zustimmung seines gesetzlichen Vertreters** geschlossener Vertrag gilt nach **§ 110 BGB** ggf. **als von Anfang an wirksam**.\nDies setzt voraus, dass der Minderjährige die von ihm geschuldete Leistung **mit Mitteln bewirkt**, die ihm **zu diesem Zweck oder zu freier Verfügung** von dem Vertreter oder mit dessen Zustimmung von einem Dritten überlassen worden sind.\nHier hat der Minderjährige den **Kaufpreis vollständig aus seinem angesparten Taschengeld**, das ihm **zur freien Verfügung überlassen wurde**, bezahlt.\n**Folglich bedarf der Kaufvertrag zu seiner Wirksamkeit nicht mehr der Zustimmung der Eltern** des Minderjährigen nach **§ 108 Abs. 1 BGB**.\nZahlt der Minderjährige den Kaufpreis aber **nicht vollständig aus seinem angesparten Taschengeld**, greift **§ 110 BGB nicht**, d.h. der Vertrag gilt (zunächst) **nicht als von Anfang an wirksam**.\nIn der Fallvariante fehlten dem Minderjährigen **200 €** zur vollständigen Kaufpreiszahlung. Dementsprechend wurde der Kaufpreis **bis zur Zahlung der letzten Kaufpreisrate nicht mit Mitteln**, die dem Minderjährigen **zur freien Verfügung überlassen wurden**, bezahlt („… wenn der Minderjährige die vertragsmäßige Leistung mit Mitteln bewirkt …“).\n**Folglich ist § 110 BGB hier nicht zu Gunsten des Minderjährigen anzuwenden.**\nDer **Kaufvertrag über das Fahrrad** bedarf also in der Fallvariante **bis zur Zahlung der letzten Kaufpreisrate der Zustimmung der Eltern** des Minderjährigen nach **§ 108 Abs. 1 BGB**"
                        }
                    ]
                ]
            },
     {
                name: "Wirth",
                field: "AO, FGO, Erbschaftsteuer, Grunderwerbsteuer",
                avatar: "W",
                image: "https://s1.directupload.eu/images/250829/qoko6duz.jpg",
                rounds: [
                    [
                        {
                            question: "Ich prüfe Sie heute in der Abgabenordnung. Ich würde gerne thematisch an die Fragerunde von Herrn Dr. Dumser anknüpfen. Können Sie mir zunächst sagen, ob ein beschränkt Geschäftsfähiger überhaupt eine Steuererklärung abgeben kann?",
                            audio: "https://www.dropbox.com/scl/fi/pbq684l19gbmb3gk0ky68/k.m.1.mp3?rlkey=gs36uqtpuzb1362a1p5gdwy0l&st=sfiy0q2b&raw=1",
                            solution: "Nach **§ 149 Abs. 1 AO** bestimmen die Steuergesetze, wer zur Abgabe einer **Steuererklärung verpflichtet** ist.\nHandelt es sich dabei um einen **beschränkt Geschäftsfähigen**, also einen **Minderjährigen**, der das **7., aber noch nicht das 18. Lebensjahr** vollendet hat (**§ 106 BGB**), ist danach zu differenzieren, ob er **steuerlich handlungsfähig** ist oder nicht.\n\n**Beschränkt Geschäftsfähige** können nach **§ 79 Abs. 1 Nr. 2 AO** steuerlich handlungsfähig sein, soweit sie für den Gegenstand des Verfahrens durch Vorschriften des **bürgerlichen Rechts** als geschäftsfähig oder durch Vorschriften des **öffentlichen Rechts** als handlungsfähig anerkannt sind.\nDies ist v. a. der Fall bei **Ermächtigung des Minderjährigen zum selbständigen Betrieb eines Erwerbsgeschäfts** für alle Geschäfte, die der Betrieb mit sich bringt (**§ 112 BGB**), oder im Rahmen eines **Dienst- oder Arbeitsverhältnisses (§ 113 BGB)**.\nSoweit sich nach diesen Vorschriften eine beschränkte Geschäftsfähigkeit ergibt, ist der Minderjährige **steuerlich handlungsfähig** und kann z. B. als **Inhaber eines Gewerbebetriebs** wirksam Erklärungen und Anmeldungen zur **USt**, **LSt** und **GewSt** abgeben.\n\nIst ein beschränkt Geschäftsfähiger nach den Vorschriften des bürgerlichen oder öffentlichen Rechts **nicht handlungsfähig**, muss der **gesetzliche Vertreter** für ihn handeln, um die steuerlichen Pflichten des beschränkt Geschäftsfähigen zu erfüllen (**§ 34 Abs. 1 S. 1 AO**).\nBei Minderjährigen sind regelmäßig die **Eltern gemeinsam gesetzliche Vertreter** (**§§ 1626, 1629 Abs. 1 S. 2 BGB**).\nIn diesem Fall müssen also die **Eltern als gesetzliche Vertreter** des beschränkt Geschäftsfähigen dessen **Steuererklärung abgeben**.\n\nDies gilt im Übrigen auch für die **Abgabe einer Einkommensteuererklärung** bei einem nach **§ 79 Abs. 1 Nr. 2 AO handlungsfähigen Minderjährigen**.\nDenn die Abgabe einer Einkommensteuererklärung ist **nicht von §§ 112 und 113 BGB umfasst**, weil hierbei auch Angaben zu den **Sonderausgaben** oder **außergewöhnlichen Belastungen** erforderlich sind, die nichts mit dem **Erwerbsgeschäft i. S. d. § 112 BGB** oder dem **Dienst- oder Arbeitsverhältnis i. S. d. § 113 BGB** zu tun haben."
                        },
                        {
                            question: "Ich habe Ihnen dazu einen kleinen Fall mitgebracht: Ein Minderjähriger betreibt in der Garage seiner Eltern einen Gewerbebetrieb und ist insoweit auch partiell geschäftsfähig nach § 112 Abs. 1 BGB. Das Finanzamt will einen Umsatzsteuerbescheid an ihn bekanntgeben. An wen ist dieser zu adressieren?",
                            audio: "https://www.dropbox.com/scl/fi/rbcr1t4ef6a9y0lv12xz4/k.m.2.mp3?rlkey=5zaolj6yx8qpdhbj92krc90qe&st=zvy3k4xq&raw=1",
                            solution: " **Ermächtigt der gesetzliche Vertreter mit Genehmigung des Familiengerichts den Minderjährigen zum selbständigen Betrieb eines Erwerbsgeschäfts**, so ist der Minderjährige für solche Rechtsgeschäfte **unbeschränkt geschäftsfähig**, welche der Geschäftsbetrieb mit sich bringt (**§ 112 Abs. 1 S. 1 BGB**).\nInsoweit ist der Minderjährige auch im **Besteuerungsverfahren handlungsfähig** nach **§ 79 Abs. 1 Nr. 2 AO**.\n\nDementsprechend sind **Steuerbescheide**, die **ausschließlich diesen Geschäftsbetrieb betreffen**, wie hier der **Umsatzsteuerbescheid**, **nur dem Minderjährigen** – und **nicht auch dessen Eltern** als (gemeinschaftliche) gesetzliche Vertreter nach **§ 34 Abs. 1 S. 1 AO i.V.m. §§ 1626, 1629 Abs. 1 S. 2 BGB** – bekannt zu geben (**vgl. AEAO zu § 122, Nr. 2.2.3**)."
                        },
                        {
                            question: " Der Minderjährige erzielt neben dem Gewerbebetrieb noch andere Einkünfte. Das Finanzamt will einen Einkommensteuerbescheid, der neben den Einkünften aus Gewerbebetrieb noch andere Einkünfte des Minderjährigen beinhaltet, an ihn bekanntgeben. An wen ist dieser zu adressieren?",
                            audio: "https://www.dropbox.com/scl/fi/tlp8epjdc0gpknrepo74k/k.m.3.mp3?rlkey=nkiv5fh42b7847knn0z2kh964&st=aa8ldt5v&raw=1",
                            solution: "Hat der Minderjährige wie hier **noch weitere Einkünfte** und werden diese in die **Festsetzung einbezogen**, so kann der **Steuerbescheid nicht durch Bekanntgabe gegenüber dem minderjährigen Steuerschuldner** wirksam werden.\n**Bekanntgabeadressat des Bescheids** sind in einem solchen Fall die **Eltern des Minderjährigen** als dessen (gemeinschaftliche) **gesetzliche Vertreter** nach **§ 34 Abs. 1 S. 1 AO i.V.m. §§ 1626, 1629 Abs. 1 S. 2 BGB** (**vgl. AEAO zu § 122, Nr. 2.2.3 a.E.**)."
                        },
                        {
                            question: "Sehr schön, vielen Dank. Jetzt gehen wir zum Abschluss nochmal weg von dem Minderjährigen. Zählen Sie mir bitte die steuerlichen Nebenleistungen in der AO auf und sagen Sie mir, wo sie im Gesetz stehen.",
                            audio: "https://www.dropbox.com/scl/fi/q9qi6noldt5y819hjryyj/k.m.4.mp3?rlkey=lto7ejfud1h84z8d26fvbarh2&st=54ekgex4&raw=1",
                            solution: " **Steuerliche Nebenleistungen** sind nach **§ 3 Abs. 4 AO** u. a.:\n• **Verspätungszuschläge** nach **§ 152 AO**\n• **Zuschläge** nach **§ 162 Abs. 4 und 4a AO**\n• **Mitwirkungsverzögerungsgelder** nach **§ 200a Abs. 2 AO** und **Zuschläge zum Mitwirkungsverzögerungsgeld** nach **§ 200a Abs. 3 AO**\n• **Zinsen** nach den **§§ 233 ff. AO**\n• **Säumniszuschläge** nach **§ 240 AO**\n• **Zwangsgelder** nach **§ 329 AO**"
                        },
                        {
                            question: "Und dann noch eine letzte Frage: Was ist der Sinn und Zweck von Säumniszuschlägen? Und worin liegt der Unterschied zu Verspätungszuschlägen?",
                            audio: "https://www.dropbox.com/scl/fi/94l61y9u0zmyya0447o6a/k.m.5.mp3?rlkey=o92fswdll4rwroku3bbiw1w8k&st=9d84q7v9&raw=1",
                            solution: " **Säumniszuschläge** stellen in erster Linie ein **Druckmittel zur Durchsetzung fälliger Steuerforderungen** dar. Sie sind aber auch eine **Gegenleistung für das Hinausschieben der Zahlung** und ein **Ausgleich für den angefallenen Verwaltungsaufwand** (**AEAO zu § 240, Nr. 5**).\n\nBei Vorliegen der **Tatbestandsmerkmale des § 152 Abs. 1 S. 1 AO** (Erklärungspflicht, verspätete oder Nichtabgabe der Steuererklärung, Verschulden) kann ein **Verspätungszuschlag** festgesetzt werden (**Ermessensentscheidung**).\nDas Finanzamt hat nach **pflichtgemäßem Ermessen (§ 5 AO)** zu entscheiden, ob und in welcher Höhe ein Verspätungszuschlag festzusetzen ist.\n\nDie **Festsetzung des Verspätungszuschlags** stellt eine **gebundene Entscheidung** dar, insbesondere wenn die Steuererklärung **nicht binnen 14 Monaten nach Ablauf des Kalenderjahrs** oder in den Fällen **vorzeitiger Anforderung** pflichtwidrig nicht bis zu dem in der Anordnung bestimmten Zeitpunkt abgegeben wurde (**§ 152 Abs. 2 AO**).\n\nAufgrund der **pandemiebedingten Verlängerung der Abgabefristen** gibt es für die **Besteuerungszeiträume 2020 bis 2024** in Bezug auf **§ 152 Abs. 2 AO** **Sonderregelungen**, mithin für die Frage, ob ein Verspätungszuschlag von Amts wegen festzusetzen ist (**siehe AEAO zu § 152, Nr. 1**).\n\nDemgegenüber entsteht ein **Säumniszuschlag kraft Gesetzes**, wenn eine Steuer **nicht am Fälligkeitstag entrichtet** wird (**§ 240 Abs. 1 S. 1 AO**).\nDas Finanzamt hat hierbei **kein Ermessen**. Der Säumniszuschlag wird **nicht durch Verwaltungsakt festgesetzt**, sondern **im Rahmen der Anmahnung von Steuerrückständen angefordert**.\nEtwaige **Unbilligkeiten** können durch **Erlass der Säumniszuschläge** beseitigt werden (**§ 227 AO**)."
                        }
                    ]
                ]
            }
        ];

        // Initialize examiners with randomly selected rounds
        let examiners = [];

        let currentExaminerIndex = 0;
        let currentQuestionIndex = 0;
        let preparationTimer;
        let preparationTimeLeft = 1800; // 30 minutes in seconds
        
        // Presentation timer variables
        let presentationTimer;
        let presentationTimeElapsed = 0;
        let isPresentationTimerRunning = false;
        
        let examResponses = [];

        // Function to initialize examiners with random rounds
        function initializeExaminers() {
            examiners = examinerData.map(examinerTemplate => {
                // Select a random round (0-4) for each examiner
                const randomRoundIndex = Math.floor(Math.random() * examinerTemplate.rounds.length);
                const selectedRound = examinerTemplate.rounds[randomRoundIndex];
                
                return {
                    name: examinerTemplate.name,
                    field: examinerTemplate.field,
                    avatar: examinerTemplate.avatar,
                    image: examinerTemplate.image,
                    questions: selectedRound
                };
            });
            
            console.log('Prüfer mit zufälligen Runden initialisiert:', examiners.map(e => e.name));
        }

        function generateRandomTopics() {
            const selectedTopics = [];
            
            // Gruppe 1: Grundlagen des Steuerrechts (erstes Thema)
            const group1Categories = ["Privatrecht", "Finanzgerichtsordnung", "Abgabenordnung"];
            const randomGroup1Category = group1Categories[Math.floor(Math.random() * group1Categories.length)];
            const group1Topics = topicsByCategory[randomGroup1Category];
            const selectedGroup1Topic = group1Topics[Math.floor(Math.random() * group1Topics.length)];
            selectedTopics.push({
                topic: selectedGroup1Topic,
                category: randomGroup1Category
            });
            
            // Gruppe 2: Ertragsteuern (zweites Thema)
            const group2Categories = ["Einkommensteuer", "Bilanzsteuer", "Körperschaftsteuer"];
            const randomGroup2Category = group2Categories[Math.floor(Math.random() * group2Categories.length)];
            const group2Topics = topicsByCategory[randomGroup2Category];
            const selectedGroup2Topic = group2Topics[Math.floor(Math.random() * group2Topics.length)];
            selectedTopics.push({
                topic: selectedGroup2Topic,
                category: randomGroup2Category
            });
            
            // Gruppe 3: Spezialgebiete (drittes Thema)
            const group3Categories = ["Umsatzsteuer", "Umwandlungssteuer", "Internationales Steuerrecht", "Berufsrecht"];
            const randomGroup3Category = group3Categories[Math.floor(Math.random() * group3Categories.length)];
            const group3Topics = topicsByCategory[randomGroup3Category];
            const selectedGroup3Topic = group3Topics[Math.floor(Math.random() * group3Topics.length)];
            selectedTopics.push({
                topic: selectedGroup3Topic,
                category: randomGroup3Category
            });
            
            return selectedTopics;
        }

        function selectTopic(topicData, buttonElement) {
            console.log('Thema ausgewählt:', topicData);
            selectedTopicText = topicData.topic;
            
            const selectedTopicElement = document.getElementById('selectedTopic');
            if (selectedTopicElement) {
                selectedTopicElement.textContent = `"${topicData.topic}"`;
            }
            
            // Update button states
            document.querySelectorAll('.topic-button').forEach(btn => {
                btn.classList.remove('selected');
                btn.style.background = 'white';
                btn.style.borderColor = '#d1d5db';
            });
            
            if (buttonElement) {
                buttonElement.classList.add('selected');
                buttonElement.style.background = 'linear-gradient(180deg, rgba(111, 172, 255, 0.1), rgba(170, 207, 255, 0.1))';
                buttonElement.style.borderColor = '#6facff';
            }
            
            // Enable proceed button
            const proceedButton = document.getElementById('proceedButton');
            if (proceedButton) {
                proceedButton.disabled = false;
                proceedButton.style.opacity = '1';
                proceedButton.style.cursor = 'pointer';
                console.log('Button aktiviert');
            }
        }

function displayTopicOptions() {
  const topicOptions = document.getElementById('topicOptions');
  if (!topicOptions) {
    console.error('topicOptions Element nicht gefunden');
    return;
  }

  topicOptions.innerHTML = '';

  // Alle Kategorien & Themen exakt so ausgeben, wie sie in topicsByCategory stehen
  Object.entries(topicsByCategory).forEach(([rawCategory, topics]) => {
    const category = (rawCategory || '').trim(); // toleranter Umgang mit Leerzeichen im Key

    if (!Array.isArray(topics) || topics.length === 0) return;

    topics.forEach((topic, index) => {
      const topicButton = document.createElement('div');
      topicButton.className = 'topic-button p-4 border-2 border-gray-300 rounded-lg cursor-pointer transition-all hover:border-blue-400';
      topicButton.style.background = 'white';
      topicButton.onclick = () => selectTopic({ topic, category }, topicButton);

      topicButton.innerHTML = `
        <div class="flex items-start">
          <span class="w-8 h-8 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3 flex-shrink-0" style="background: #6facff;">
            ${index + 1}
          </span>
          <div class="flex-1">
            <div class="text-gray-800 font-medium mb-1">${topic}</div>
            <div class="text-xs px-2 py-1 rounded-full inline-block" style="background-color: rgba(111, 172, 255, 0.2); color: #6facff;">
              ${category}
            </div>
          </div>
        </div>
      `;

      topicOptions.appendChild(topicButton);
    });
  });
}
        function startExam() {
            console.log('startExam() aufgerufen');
            
            // Stop welcome audio
            stopAllAudio();
            
            const welcomeScreen = document.getElementById('welcomeScreen');
            const preparationPhase = document.getElementById('preparationPhase');
            
            if (welcomeScreen) welcomeScreen.classList.add('hidden');
            if (preparationPhase) preparationPhase.classList.remove('hidden');
            
            // Generate and display topics immediately
            displayTopicOptions();
            startPreparationTimer();
        }

        function startPreparationTimer() {
            preparationTimer = setInterval(() => {
                preparationTimeLeft--;
                updateTimerDisplay();
                
                if (preparationTimeLeft <= 0) {
                    clearInterval(preparationTimer);
                    skipToExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(preparationTimeLeft / 60);
            const seconds = preparationTimeLeft % 60;
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('timerDisplay').textContent = timeString;
            
            // Update circle progress
            const totalTime = 1800;
            const progress = ((totalTime - preparationTimeLeft) / totalTime) * 360;
            document.getElementById('timerCircle').style.background = 
                `conic-gradient(#ef4444 ${progress}deg, #f3f4f6 ${progress}deg)`;
        }

        function skipToExam() {
            console.log('skipToExam() aufgerufen');
            
            // Check if topic is selected
            if (!selectedTopicText) {
                alert('Bitte wählen Sie zunächst ein Thema aus!');
                return;
            }
            
            if (preparationTimer) {
                clearInterval(preparationTimer);
            }
            
            // Stop all audio before phase change
            stopAllAudio();
            
            const preparationPhase = document.getElementById('preparationPhase');
            const presentationPhase = document.getElementById('presentationPhase');
            const phaseIndicator = document.getElementById('phaseIndicator');
            
            if (preparationPhase) preparationPhase.classList.add('hidden');
            if (presentationPhase) presentationPhase.classList.remove('hidden');
            if (phaseIndicator) phaseIndicator.textContent = 'Vortrag';
            
            // Auto-play presentation audio after a short delay
            setTimeout(() => {
                const presentationAudio = document.getElementById('presentationAudio');
                if (presentationAudio) {
                    presentationAudio.play().catch(e => console.log('Autoplay prevented:', e));
                }
            }, 500);
        }

        function setupExaminerGrid() {
            const grid = document.getElementById('examinerGrid');
            grid.innerHTML = '';
            
            examiners.forEach((examiner, index) => {
                const examinerCard = document.createElement('div');
                examinerCard.className = `text-center p-3 rounded-lg border-2 transition-colors ${
                    index === currentExaminerIndex ? 'border-gray-200' : 'border-gray-200'
                }`;
                
                if (index === currentExaminerIndex) {
                    examinerCard.style.background = 'linear-gradient(180deg, rgba(111, 172, 255, 0.1), rgba(170, 207, 255, 0.1))';
                    examinerCard.style.borderColor = '#6facff';
                }
                
                let avatarContent = '';
                if (examiner.image) {
                    avatarContent = `
                        <img src="${examiner.image}" alt="${examiner.name}" class="w-full h-full object-cover rounded-full" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold rounded-full" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">${examiner.avatar}</div>
                    `;
                } else {
                    avatarContent = examiner.avatar;
                }
                
                examinerCard.innerHTML = `
                    <div class="examiner-avatar" style="width: 50px; height: 50px; font-size: 16px; margin: 0 auto 8px; overflow: hidden;">
                        ${avatarContent}
                    </div>
                    <div class="text-sm font-medium text-gray-800">${examiner.name}</div>
                    <div class="text-xs text-gray-600">${examiner.field}</div>
                `;
                
                grid.appendChild(examinerCard);
            });
        }

        function finishPresentation() {
            // Store presentation response
            examResponses.push({
                examiner: 'Dr. Dumser',
                question: 'Vortrag',
                answer: 'Vortrag über Chat-Widget gehalten'
            });
            
            // Stop all audio before phase change
            stopAllAudio();
            
            // Move to transition phase
            const presentationPhase = document.getElementById('presentationPhase');
            const transitionPhase = document.getElementById('transitionPhase');
            const phaseIndicator = document.getElementById('phaseIndicator');
            
            if (presentationPhase) presentationPhase.classList.add('hidden');
            if (transitionPhase) transitionPhase.classList.remove('hidden');
            if (phaseIndicator) phaseIndicator.textContent = 'Übergang';
            
            // Auto-play transition audio after a short delay
            setTimeout(() => {
                const transitionAudio = document.getElementById('transitionAudio');
                if (transitionAudio) {
                    transitionAudio.play().catch(e => console.log('Autoplay prevented:', e));
                }
            }, 500);
        }

        function startExamQuestions() {
            // Stop all audio before phase change
            stopAllAudio();
            
            // Move to exam phase
            const transitionPhase = document.getElementById('transitionPhase');
            const examPhase = document.getElementById('examPhase');
            const phaseIndicator = document.getElementById('phaseIndicator');
            
            if (transitionPhase) transitionPhase.classList.add('hidden');
            if (examPhase) examPhase.classList.remove('hidden');
            if (phaseIndicator) phaseIndicator.textContent = 'Prüfungsgespräch';
            
            setupExaminerGrid();
            displayCurrentQuestion();
            
            // Auto-play first question audio after a short delay
            setTimeout(() => {
                const drSchmidtAudio = document.getElementById('drSchmidtAudio');
                if (drSchmidtAudio) {
                    drSchmidtAudio.play().catch(e => console.log('Autoplay prevented:', e));
                }
            }, 500);
        }

        function displayCurrentQuestion() {
            const examiner = examiners[currentExaminerIndex];
            const questionData = examiner.questions[currentQuestionIndex];
            const question = questionData.question;
            const audioUrl = questionData.audio;
            
            // Update examiner info
            const avatarElement = document.getElementById('currentExaminerAvatar');
            if (examiner.image) {
                avatarElement.innerHTML = `<img src="${examiner.image}" alt="${examiner.name}" class="w-full h-full object-cover rounded-full" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold rounded-full" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">${examiner.avatar}</div>`;
            } else {
                avatarElement.textContent = examiner.avatar;
            }
            
            document.getElementById('currentExaminerName').textContent = examiner.name;
            document.getElementById('currentExaminerField').textContent = `Fachbereich: ${examiner.field}`;
            document.getElementById('examinerProgress').textContent = `${currentExaminerIndex + 1} / ${examiners.length}`;
            
            // Update question
            document.getElementById('currentQuestion').textContent = question;
            
            // Update audio source and show player
            const audioPlayer = document.getElementById('audioPlayer');
            const drSchmidtAudio = document.getElementById('drSchmidtAudio');
            
            if (audioPlayer && drSchmidtAudio && audioUrl) {
                drSchmidtAudio.src = audioUrl;
                audioPlayer.classList.remove('hidden');
                
                // Auto-play the audio after a short delay
                setTimeout(() => {
                    drSchmidtAudio.play().catch(e => console.log('Autoplay prevented:', e));
                }, 500);
            }
            
            // Show appropriate response area
            if (examiner.name === 'Dr. Baretti') {
                document.getElementById('chatWidget').classList.remove('hidden');
                document.getElementById('standardResponse').classList.add('hidden');
            } else {
                document.getElementById('chatWidget').classList.add('hidden');
                document.getElementById('standardResponse').classList.remove('hidden');
            }
            
            setupExaminerGrid();
        }

        function nextQuestion() {
            // Store current response
            let response = '';
            if (examiners[currentExaminerIndex].name === 'Dr. Baretti') {
                response = document.getElementById('barettiResponse').value || 'Keine Antwort eingegeben';
            } else {
                response = document.getElementById('currentResponse').value || 'Keine Antwort eingegeben';
            }
            
            examResponses.push({
                examiner: examiners[currentExaminerIndex].name,
                question: examiners[currentExaminerIndex].questions[currentQuestionIndex].question,
                answer: response
            });
            
            // Stop current audio
            stopAllAudio();
            
            // Show solution phase
            showSolution();
        }

        function showSolution() {
            const examiner = examiners[currentExaminerIndex];
            const questionData = examiner.questions[currentQuestionIndex];
            const lastResponse = examResponses[examResponses.length - 1];
            
            // Hide exam phase, show solution phase
            document.getElementById('examPhase').classList.add('hidden');
            document.getElementById('solutionPhase').classList.remove('hidden');
            setPhase('Lösung');
            
            // Update solution examiner info
            const solutionAvatarElement = document.getElementById('solutionExaminerAvatar');
            if (examiner.image) {
                solutionAvatarElement.innerHTML = `<img src="${examiner.image}" alt="${examiner.name}" class="w-full h-full object-cover rounded-full" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold rounded-full" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">${examiner.avatar}</div>`;
            } else {
                solutionAvatarElement.textContent = examiner.avatar;
            }
            
            document.getElementById('solutionExaminerName').textContent = examiner.name;
            document.getElementById('solutionExaminerField').textContent = `Fachbereich: ${examiner.field}`;
            document.getElementById('solutionExaminerProgress').textContent = `${currentExaminerIndex + 1} / ${examiners.length}`;
            
            // Update solution content
            document.getElementById('solutionQuestion').textContent = questionData.question;
            document.getElementById('solutionYourAnswer').textContent = lastResponse.answer;
            
            // Format and display model solution
            const solutionText = questionData.solution || 'Musterlösung wird geladen...';
            const formattedSolution = formatSolution(solutionText);
            document.getElementById('solutionModelAnswer').innerHTML = formattedSolution;
            
            // Setup solution examiner grid
            setupSolutionExaminerGrid();
        }

        function formatSolution(solutionText) {
            // Convert markdown-like formatting to HTML
            let formatted = solutionText
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n• /g, '<li>')
                .replace(/\n/g, '<br>');
            
            // Wrap list items in ul tags
            if (formatted.includes('<li>')) {
                formatted = formatted.replace(/(<li>.*?)(<br>|$)/g, '$1</li>');
                formatted = formatted.replace(/(<li>.*?<\/li>)/g, '<ul class="list-disc list-inside space-y-2 mt-2">$1</ul>');
                formatted = formatted.replace(/<\/ul><ul class="list-disc list-inside space-y-2 mt-2">/g, '');
            }
            
            return formatted;
        }

        function setupSolutionExaminerGrid() {
            const grid = document.getElementById('solutionExaminerGrid');
            grid.innerHTML = '';
            
            examiners.forEach((examiner, index) => {
                const examinerCard = document.createElement('div');
                examinerCard.className = `text-center p-3 rounded-lg border-2 transition-colors ${
                    index === currentExaminerIndex ? 'border-gray-200' : 'border-gray-200'
                }`;
                
                if (index === currentExaminerIndex) {
                    examinerCard.style.background = 'linear-gradient(180deg, rgba(111, 172, 255, 0.1), rgba(170, 207, 255, 0.1))';
                    examinerCard.style.borderColor = '#6facff';
                }
                
                let avatarContent = '';
                if (examiner.image) {
                    avatarContent = `
                        <img src="${examiner.image}" alt="${examiner.name}" class="w-full h-full object-cover rounded-full" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="w-full h-full flex items-center justify-center text-white text-sm font-bold rounded-full" style="background: linear-gradient(180deg, #6facff, #aacfff); display: none;">${examiner.avatar}</div>
                    `;
                } else {
                    avatarContent = examiner.avatar;
                }
                
                examinerCard.innerHTML = `
                    <div class="examiner-avatar" style="width: 50px; height: 50px; font-size: 16px; margin: 0 auto 8px; overflow: hidden;">
                        ${avatarContent}
                    </div>
                    <div class="text-sm font-medium text-gray-800">${examiner.name}</div>
                    <div class="text-xs text-gray-600">${examiner.field}</div>
                `;
                
                grid.appendChild(examinerCard);
            });
        }

        function continueToNextQuestion() {
            console.log('continueToNextQuestion aufgerufen');
            console.log('Aktueller Prüfer:', currentExaminerIndex, 'Aktuelle Frage:', currentQuestionIndex);
            
            // Clear response fields
            if (document.getElementById('barettiResponse')) {
                document.getElementById('barettiResponse').value = '';
            }
            if (document.getElementById('currentResponse')) {
                document.getElementById('currentResponse').value = '';
            }
            
            // Move to next question or examiner
            currentQuestionIndex++;
            console.log('Nach Erhöhung - Frage:', currentQuestionIndex, 'von', examiners[currentExaminerIndex].questions.length);
            
            if (currentQuestionIndex >= examiners[currentExaminerIndex].questions.length) {
                // Move to next examiner
                currentExaminerIndex++;
                currentQuestionIndex = 0;
                console.log('Wechsel zu Prüfer:', currentExaminerIndex, 'von', examiners.length);
                
                if (currentExaminerIndex >= examiners.length) {
                    // Exam finished
                    console.log('Prüfung beendet');
                    showResults();
                    return;
                }
            }
            
            // Stop all audio before phase change
            stopAllAudio();
            
            // Hide solution phase, show exam phase
            document.getElementById('solutionPhase').classList.add('hidden');
            document.getElementById('examPhase').classList.remove('hidden');
            setPhase('Prüfungsgespräch');
            
            console.log('Zeige neue Frage an');
            displayCurrentQuestion();
        }

        function backToQuestion() {
            // Hide solution phase, show exam phase
            document.getElementById('solutionPhase').classList.add('hidden');
            document.getElementById('examPhase').classList.remove('hidden');
            setPhase('Prüfungsgespräch');        }

        function showResults() {
            // Stop all audio
            stopAllAudio();
            
            const solutionPhase = document.getElementById('solutionPhase');
            const resultsPhase = document.getElementById('resultsPhase');
            const phaseIndicator = document.getElementById('phaseIndicator');
            
            if (solutionPhase) solutionPhase.classList.add('hidden');
            if (resultsPhase) resultsPhase.classList.remove('hidden');
            if (phaseIndicator) phaseIndicator.textContent = 'Ergebnis';
        }

        function restartExam() {
            // Reset all variables
            currentExaminerIndex = 0;
            currentQuestionIndex = 0;
            selectedTopicText = '';
            examResponses = [];
            preparationTimeLeft = 1800;
            presentationTimeElapsed = 0;
            isPresentationTimerRunning = false;
            
            // Clear timers
            if (preparationTimer) clearInterval(preparationTimer);
            if (presentationTimer) clearInterval(presentationTimer);
            
            // Stop all audio
            stopAllAudio();
            
            // Reinitialize examiners
            initializeExaminers();
            
            // Show welcome screen
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('preparationPhase').classList.add('hidden');
            document.getElementById('presentationPhase').classList.add('hidden');
            document.getElementById('transitionPhase').classList.add('hidden');
            document.getElementById('examPhase').classList.add('hidden');
            document.getElementById('solutionPhase').classList.add('hidden');
            document.getElementById('resultsPhase').classList.add('hidden');
            
            // Reset phase indicator
            setPhase('Vorbereitung');
        }

        function clearResponse() {
            document.getElementById('currentResponse').value = '';
        }

        function clearBarettiResponse() {
            document.getElementById('barettiResponse').value = '';
        }

        function showSampleSolution() {
            // Get the appropriate solution (specific or general)
            let solutionData = presentationSolutions.general;
            
            // Check if there's a specific solution for the selected topic
            if (presentationSolutions.specific[selectedTopicText]) {
                solutionData = presentationSolutions.specific[selectedTopicText];
            }
            
            // Create modal overlay
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modalOverlay.onclick = (e) => {
                if (e.target === modalOverlay) {
                    document.body.removeChild(modalOverlay);
                }
            };
            
            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.className = 'bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto';
            
            // Generate HTML for solution sections
            function generateSectionHTML(section) {
                const pointsHTML = section.points.map(point => `<li>${point}</li>`).join('');
                return `
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3">${section.title}</h4>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            ${pointsHTML}
                        </ul>
                    </div>
                `;
            }
            
            modalContent.innerHTML = `
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-800">Musterlösung für Ihren Vortrag</h3>
                        <button onclick="document.body.removeChild(this.closest('.fixed'))" class="text-gray-500 hover:text-gray-700 text-2xl font-bold">&times;</button>
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-4 mb-6">
                        <h4 class="text-lg font-semibold text-blue-800 mb-2">Gewähltes Thema:</h4>
                        <p class="text-blue-700">"${selectedTopicText}"</p>
                    </div>
                    
                    <div class="space-y-6">
                        ${generateSectionHTML(solutionData.introduction)}
                        ${generateSectionHTML(solutionData.mainPart)}
                        ${generateSectionHTML(solutionData.conclusion)}
                    </div>
                    
                    <div class="mt-6 text-center">
                        <button onclick="document.body.removeChild(this.closest('.fixed'))" class="text-white px-6 py-2 rounded-lg font-medium transition-all" style="background: linear-gradient(180deg, #6facff, #aacfff); box-shadow: 0 2px 4px rgba(111, 172, 255, 0.3);" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                            Schließen
                        </button>
                    </div>
                </div>
            `;
            
            modalOverlay.appendChild(modalContent);
            document.body.appendChild(modalOverlay);
        }

        // Presentation timer functions
        function startPresentationTimer() {
            if (!isPresentationTimerRunning) {
                isPresentationTimerRunning = true;
                presentationTimer = setInterval(() => {
                    presentationTimeElapsed++;
                    updatePresentationTimerDisplay();
                }, 1000);
                
                document.getElementById('startTimerBtn').disabled = true;
                document.getElementById('pauseTimerBtn').disabled = false;
            }
        }

        function pausePresentationTimer() {
            if (isPresentationTimerRunning) {
                isPresentationTimerRunning = false;
                clearInterval(presentationTimer);
                
                document.getElementById('startTimerBtn').disabled = false;
                document.getElementById('pauseTimerBtn').disabled = true;
            }
        }

        function resetPresentationTimer() {
            isPresentationTimerRunning = false;
            clearInterval(presentationTimer);
            presentationTimeElapsed = 0;
            updatePresentationTimerDisplay();
            
            document.getElementById('startTimerBtn').disabled = false;
            document.getElementById('pauseTimerBtn').disabled = true;
        }

        function updatePresentationTimerDisplay() {
            const minutes = Math.floor(presentationTimeElapsed / 60);
            const seconds = presentationTimeElapsed % 60;
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('presentationTimer').textContent = timeString;
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeExaminers();
            console.log('Seite geladen, Prüfer initialisiert');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98553e7ab01d1dbb',t:'MTc1ODkxNTc0Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

